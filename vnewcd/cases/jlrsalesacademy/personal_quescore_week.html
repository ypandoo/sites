<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-touch-fullscreen" content="yes">
<meta http-equiv="Access-Control-Allow-Origin" content="*">
<link rel="stylesheet" href="css/base.css" />
<link rel="stylesheet" href="css/jquery.dynatable.css" />
<title>个人积分</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
</head>
 <style>
table {
    max-width: 100%;
    background-color: transparent;
    border-collapse: collapse;
    border-spacing: 0
}

.table {
    width: 100%;
    margin-bottom: 20px
}

.table th,
.table td {
    padding: 8px;
    line-height: 20px;
    text-align: left;
    vertical-align: top;
    border-top: 1px solid #ddd
}

.table th {
    font-weight: bold
}

.table thead th {
    vertical-align: bottom
}

.table caption+thead tr:first-child th,
.table caption+thead tr:first-child td,
.table colgroup+thead tr:first-child th,
.table colgroup+thead tr:first-child td,
.table thead:first-child tr:first-child th,
.table thead:first-child tr:first-child td {
    border-top: 0
}

.table tbody+tbody {
    border-top: 2px solid #ddd
}

.table .table {
    background-color: #fff
}

.table-condensed th,
.table-condensed td {
    padding: 4px 5px
}

.table-bordered {
    border: 1px solid #ddd;
    border-collapse: separate;
    *border-collapse: collapse;
    border-left: 0;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px
}

.table-bordered th,
.table-bordered td {
    border-left: 1px solid #ddd
}

.table-bordered caption+thead tr:first-child th,
.table-bordered caption+tbody tr:first-child th,
.table-bordered caption+tbody tr:first-child td,
.table-bordered colgroup+thead tr:first-child th,
.table-bordered colgroup+tbody tr:first-child th,
.table-bordered colgroup+tbody tr:first-child td,
.table-bordered thead:first-child tr:first-child th,
.table-bordered tbody:first-child tr:first-child th,
.table-bordered tbody:first-child tr:first-child td {
    border-top: 0
}

.table-bordered thead:first-child tr:first-child>th:first-child,
.table-bordered tbody:first-child tr:first-child>td:first-child,
.table-bordered tbody:first-child tr:first-child>th:first-child {
    -webkit-border-top-left-radius: 4px;
    border-top-left-radius: 4px;
    -moz-border-radius-topleft: 4px
}

.table-bordered thead:first-child tr:first-child>th:last-child,
.table-bordered tbody:first-child tr:first-child>td:last-child,
.table-bordered tbody:first-child tr:first-child>th:last-child {
    -webkit-border-top-right-radius: 4px;
    border-top-right-radius: 4px;
    -moz-border-radius-topright: 4px
}

.table-bordered thead:last-child tr:last-child>th:first-child,
.table-bordered tbody:last-child tr:last-child>td:first-child,
.table-bordered tbody:last-child tr:last-child>th:first-child,
.table-bordered tfoot:last-child tr:last-child>td:first-child,
.table-bordered tfoot:last-child tr:last-child>th:first-child {
    -webkit-border-bottom-left-radius: 4px;
    border-bottom-left-radius: 4px;
    -moz-border-radius-bottomleft: 4px
}

.table-bordered thead:last-child tr:last-child>th:last-child,
.table-bordered tbody:last-child tr:last-child>td:last-child,
.table-bordered tbody:last-child tr:last-child>th:last-child,
.table-bordered tfoot:last-child tr:last-child>td:last-child,
.table-bordered tfoot:last-child tr:last-child>th:last-child {
    -webkit-border-bottom-right-radius: 4px;
    border-bottom-right-radius: 4px;
    -moz-border-radius-bottomright: 4px
}

.table-bordered tfoot+tbody:last-child tr:last-child td:first-child {
    -webkit-border-bottom-left-radius: 0;
    border-bottom-left-radius: 0;
    -moz-border-radius-bottomleft: 0
}

.table-bordered tfoot+tbody:last-child tr:last-child td:last-child {
    -webkit-border-bottom-right-radius: 0;
    border-bottom-right-radius: 0;
    -moz-border-radius-bottomright: 0
}

.table-bordered caption+thead tr:first-child th:first-child,
.table-bordered caption+tbody tr:first-child td:first-child,
.table-bordered colgroup+thead tr:first-child th:first-child,
.table-bordered colgroup+tbody tr:first-child td:first-child {
    -webkit-border-top-left-radius: 4px;
    border-top-left-radius: 4px;
    -moz-border-radius-topleft: 4px
}

.table-bordered caption+thead tr:first-child th:last-child,
.table-bordered caption+tbody tr:first-child td:last-child,
.table-bordered colgroup+thead tr:first-child th:last-child,
.table-bordered colgroup+tbody tr:first-child td:last-child {
    -webkit-border-top-right-radius: 4px;
    border-top-right-radius: 4px;
    -moz-border-radius-topright: 4px
}

.table-striped tbody>tr:nth-child(odd)>td,
.table-striped tbody>tr:nth-child(odd)>th {
    background-color: #f9f9f9
}

.table-hover tbody tr:hover>td,
.table-hover tbody tr:hover>th {
    background-color: #f5f5f5
}

table td[class*="span"],
table th[class*="span"],
.row-fluid table td[class*="span"],
.row-fluid table th[class*="span"] {
    display: table-cell;
    float: none;
    margin-left: 0
}

.table td.span1,
.table th.span1 {
    float: none;
    width: 44px;
    margin-left: 0
}

.table td.span2,
.table th.span2 {
    float: none;
    width: 124px;
    margin-left: 0
}

.table td.span3,
.table th.span3 {
    float: none;
    width: 204px;
    margin-left: 0
}

.table td.span4,
.table th.span4 {
    float: none;
    width: 284px;
    margin-left: 0
}

.table td.span5,
.table th.span5 {
    float: none;
    width: 364px;
    margin-left: 0
}

.table td.span6,
.table th.span6 {
    float: none;
    width: 444px;
    margin-left: 0
}

.table td.span7,
.table th.span7 {
    float: none;
    width: 524px;
    margin-left: 0
}

.table td.span8,
.table th.span8 {
    float: none;
    width: 604px;
    margin-left: 0
}

.table td.span9,
.table th.span9 {
    float: none;
    width: 684px;
    margin-left: 0
}

.table td.span10,
.table th.span10 {
    float: none;
    width: 764px;
    margin-left: 0
}

.table td.span11,
.table th.span11 {
    float: none;
    width: 844px;
    margin-left: 0
}

.table td.span12,
.table th.span12 {
    float: none;
    width: 924px;
    margin-left: 0
}

.table tbody tr.success>td {
    background-color: #dff0d8
}

.table tbody tr.error>td {
    background-color: #f2dede
}

.table tbody tr.warning>td {
    background-color: #fcf8e3
}

.table tbody tr.info>td {
    background-color: #d9edf7
}

.table-hover tbody tr.success:hover>td {
    background-color: #d0e9c6
}

.table-hover tbody tr.error:hover>td {
    background-color: #ebcccc
}

.table-hover tbody tr.warning:hover>td {
    background-color: #faf2cc
}

.table-hover tbody tr.info:hover>td {
    background-color: #c4e3f3
}
 </style>

<body>
	<script>
		var phone = localStorage.mobile;
	</script>
	
	<header id="header" class="header-topbar">
		<a class="go-back" href="info.html"><img src="images/go_back.png"/></a>
		<h1 class="header-title">本周成绩</h1>
	</header>
	<div style="margin-top:15px; text-align:center">
		<span id="total_score" style="font-size:1.5em; font-weight:bold; color:#00925f; "></span>
	</div>
	<div style="margin-top:15px">
		        <table id="my-table" class="table table-bordered">
                <thead>
                    <tr>
                        <!--th data-dynatable-column="DAYOFWEEK(`bonus_date`)" class="dynatable-head">星期
                        </th-->
                        <th data-dynatable-column="bonus_date" class="dynatable-head">日期
                        </th>
						<th data-dynatable-column="daily_score" class="dynatable-head">答题成绩
                        </th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
	</div>
	
	<div style="margin-top:15px; text-align:center">
		<span id="total_bonus" style="font-size:1.5em; font-weight:bold; color:#00925f;"></span>
	</div>
	<div style="margin-top:15px">
		        <table id="my-table-bonus" class="table table-bordered">
                <thead>
                    <tr>
                        <!--th data-dynatable-column="DAYOFWEEK(`bonus_date`)" class="dynatable-head">星期
                        </th-->
                        <th data-dynatable-column="bonus_date" class="dynatable-head">日期
                        </th>
						<th data-dynatable-column="bonus_score" class="dynatable-head">获得积分
                        </th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
	</div>
	
	<script src="js/jquery-2.0.3.min.js"></script>
	<script src="js/jquery.dynatable.js"></script>
	
	<script type="text/javascript">
	$(document).ready ( function(){
		if(!localStorage.mobile || !localStorage.jlrlogin || localStorage.jlrlogin == 0)
		{
			sessionStorage.preTab = "info.html";
			window.location.href = "login.html";
		}
		
		//dina table
		//$('#my-table').dynatable();
		var submit_data = {
				'phone': localStorage.mobile,
			};
		$.ajax({
         url: 'personal_quescore_week.php',
         type: "POST",
         data: submit_data,
         dataType: "json",
		 async: false,
         success:function(data) {
		 
			//change json
			var total = 0;
			for(var i = 0; i < data.length; ++i)
			{
				var weekday = (parseInt(data[i]['DAYOFWEEK(`bonus_date`)'])-1);
				switch (weekday)
				{
				case 0:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期天";
				  break;
				case 1:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期一";
				  break;
				case 2:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期二";
				  break;
				case 3:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期三";
				  break;
				case 4:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期四";
				  break;
				case 5:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期五";
				  break;
				case 6:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期六";
				  break;
				}
				total += parseInt(data[i]["daily_score"]);
			}
			
			$("#total_score").html("本周答题成绩: " + total); 
			
			$('#my-table').dynatable({
				  dataset: {
					records: data
				  },
				  
				  features: {
				  paginate: false,
				  recordCount: false,
				  sorting: false,
				  search: false
				 },
				 
				 /*bodyRowSelector: 'tbody tr',
				 
				 readers: {
					_rowReader: trReader
				  },
				 /*rowReader: function(index, tr, record) {
					  var $tr = $(tr);
					  var week = $tr.find('DAYOFWEEK(`bonus_date`)').text();
				 }*/
			});
			//
			
			
			//end
			},
		 error:function(){
				alert("读取信息错误！");
				return;
			}
         });
		 
		 
		 //total 答题赠送积分
		 $.ajax({
         url: 'personal_quescore_bonus_week.php',
         type: "POST",
         data: submit_data,
         dataType: "json",
		 async: false,
         success:function(data_bonus) {
		 
			//change json
			var total = 0;
			for(var i = 0; i < data_bonus.length; ++i)
			{
				/*var weekday = (parseInt(data[i]['DAYOFWEEK(`bonus_date`)'])-1);
				switch (weekday)
				{
				case 0:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期天";
				  break;
				case 1:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期一";
				  break;
				case 2:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期二";
				  break;
				case 3:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期三";
				  break;
				case 4:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期四";
				  break;
				case 5:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期五";
				  break;
				case 6:
				  data[i]['DAYOFWEEK(`bonus_date`)']="星期六";
				  break;
				}*/
				total += parseInt(data_bonus[i]["bonus_score"]);
			}
			
			$("#total_bonus").html("本周答题获得积分: " + total); 
			
			$('#my-table-bonus').dynatable({
				  dataset: {
					records: data_bonus
				  },
				  
				  features: {
				  paginate: false,
				  recordCount: false,
				  sorting: false,
				  search: false
				 },
				 
				 /*bodyRowSelector: 'tbody tr',
				 
				 readers: {
					_rowReader: trReader
				  },
				 /*rowReader: function(index, tr, record) {
					  var $tr = $(tr);
					  var week = $tr.find('DAYOFWEEK(`bonus_date`)').text();
				 }*/
			});
			//
			
			
			//end
			},
		 error:function(){
				alert("读取信息错误！");
				return;
			}
         });
		 
	//End doc ready
	});
	</script>
	
</body>
</html>